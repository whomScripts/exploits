local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

return function(frame, speed)
	local dragToggle = nil
	local dragSpeed = speed or 0.25
	local dragInput = nil
	local dragStart = nil

	local startPosition

	frame.InputBegan:Connect(function(input)
		if
			input.UserInputType == Enum.UserInputType.MouseButton1
			or input.UserInputType == Enum.UserInputType.Touch
		then
			dragToggle = true
			dragStart = input.Position
			startPosition = frame.Position
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then
					dragToggle = false
				end
			end)
		end
	end)

	frame.InputChanged:Connect(function(input)
		if
			input.UserInputType == Enum.UserInputType.MouseMovement
			or input.UserInputType == Enum.UserInputType.Touch
		then
			dragInput = input
		end
	end)

	UserInputService.InputChanged:Connect(function(input)
		if input == dragInput and dragToggle then
			local Delta = input.Position - dragStart
			TweenService:Create(frame, TweenInfo.new(dragSpeed), {
				Position = UDim2.new(
					startPosition.X.Scale,
					startPosition.X.Offset + Delta.X,
					startPosition.Y.Scale,
					startPosition.Y.Offset + Delta.Y
				),
			}):Play()
		end
	end)
end
